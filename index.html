<!DOCTYPE html>
<html lang="es">
<head>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<link rel="stylesheet" href="style.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Diary V1</title>
  <link rel="stylesheet" href="style.css" />

<link rel="manifest" href="/AI-diary-1.1/manifest.json" />
<meta name="theme-color" content="#2F2F2F" />
</head>

<body>
  <div id="app">

    <div id="screen-home" class="screen active">
      <h1 class="title">AI Diary</h1>

     <div class="date-row">
  <button id="prev-day">&lt;</button>
  <span id="current-date-label" style="cursor:pointer;">Hoy</span>
  <button id="next-day">&gt;</button>
</div>

<!-- Calendario popup -->
<div id="calendar-popup" style="display:none; position:absolute; top:80px; left:50%; transform:translateX(-50%); background:#fff; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.15); padding:16px; z-index:200; width:300px;">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <button id="cal-prev-month" style="background:none; border:none; font-size:18px; cursor:pointer;">â€¹</button>
    <span id="cal-month-label" style="font-weight:600; font-size:14px;"></span>
    <button id="cal-next-month" style="background:none; border:none; font-size:18px; cursor:pointer;">â€º</button>
  </div>
  <div id="cal-grid" style="display:grid; grid-template-columns:repeat(7,1fr); gap:4px; text-align:center; font-size:13px;"></div>
</div>

      <div id="entries-list" class="entries-list">
        </div>


        <button id="go-to-summary" class="primary-button" style="background:#E0E0E0; color:#37352F; margin-top:auto;">
        Ver Resumen del DÃ­a âœ¨
      </button>

      <button id="go-to-weekly" class="primary-button" style="background:#E0E0E0; color:#37352F; margin-bottom:8px;">
  Ver Resumen Semanal ğŸ“Š
</button>

      <div class="fab-container">
        <button id="fab-text" class="fab-bubble fab-option">Aa</button>
        <button id="fab-audio" class="fab-bubble fab-option">ğŸ™ï¸</button>
        <button id="fab-main" class="fab-main">+</button>
      </div>
    </div>

    <div id="screen-new-text" class="screen">
      <div class="date-row" style="border:none;">
         <button id="back-from-text" style="padding-left:0; font-size:24px;">â†</button>
         <h1 class="title" style="margin:0;">Nueva Entrada</h1>
         <div style="width:30px;"></div>
      </div>

      <div class="input-box">
        <textarea id="new-text-input" placeholder="Â¿QuÃ© tienes en mente hoy?"></textarea>
      </div>

      <div class="emotion-selector">
        <p class="emotion-label">Â¿CÃ“MO TE SIENTES? (Obligatorio)</p>
        <div class="emotion-chips">
          <button type="button" class="emotion-chip" data-emotion="Miedo">Miedo</button>
          <button type="button" class="emotion-chip" data-emotion="AlegrÃ­a">AlegrÃ­a</button>
          <button type="button" class="emotion-chip" data-emotion="Tristeza">Tristeza</button>
          <button type="button" class="emotion-chip" data-emotion="Enojo">Enojo</button>
          <button type="button" class="emotion-chip" data-emotion="Afecto">Afecto</button>
        </div>
      </div>

      <button id="save-text-entry" class="primary-button">Guardar Entrada</button>
    </div>

    <div id="screen-new-audio" class="screen">
      <div class="date-row" style="border:none;">
         <button id="back-from-audio" style="padding-left:0; font-size:24px;">â†</button>
         <h1 class="title" style="margin:0;">Grabar Audio</h1>
         <div style="width:30px;"></div>
      </div>

      <div class="audio-controls">
        <button id="record-button" class="record-button"></button>
        <span id="record-status" class="audio-status">Pulsa para grabar</span>
      </div>

      <div class="input-box">
        <textarea id="audio-transcript" placeholder="La transcripciÃ³n aparecerÃ¡ aquÃ­..."></textarea>
      </div>

      <div class="emotion-selector">
        <p class="emotion-label">Â¿CÃ“MO TE SIENTES?</p>
        <div class="emotion-chips">
          <button type="button" class="emotion-chip" data-emotion="Miedo">Miedo</button>
          <button type="button" class="emotion-chip" data-emotion="AlegrÃ­a">AlegrÃ­a</button>
          <button type="button" class="emotion-chip" data-emotion="Tristeza">Tristeza</button>
          <button type="button" class="emotion-chip" data-emotion="Enojo">Enojo</button>
          <button type="button" class="emotion-chip" data-emotion="Afecto">Afecto</button>
        </div>
      </div>

      <button id="save-audio-entry" class="primary-button">Guardar Audio</button>
    </div>

    <div id="screen-summary" class="screen">
      <div class="date-row" style="border:none;">
         <button id="back-from-summary" style="padding-left:0; font-size:24px;">â†</button>
         <h1 class="title" style="margin:0;">Resumen Diario</h1>
         <div style="width:30px;"></div>
      </div>

      <h2 class="section-title">Entradas de hoy</h2>
      <div id="summary-entries" class="entries-list" style="flex:none; max-height:150px; overflow-y:auto; margin-bottom:20px;"></div>

      <h2 class="section-title">AnÃ¡lisis IA</h2>
      <div class="box">
        <p id="summary-text" class="placeholder" style="margin:0;">
          El resumen generado por IA aparecerÃ¡ aquÃ­...
        </p>
      </div>

      <button id="generate-summary" class="secondary-button" style="font-size:12px; padding:5px; margin-bottom:20px;">ğŸ”„ Regenerar (Simulado)</button>

      <h2 class="section-title">Gratitud (3 cosas)</h2>
      <div class="gratitude-list">
        <input id="gratitude-1" type="text" placeholder="1. Estoy agradecido por..." />
        <input id="gratitude-2" type="text" placeholder="2. ..." />
        <input id="gratitude-3" type="text" placeholder="3. ..." />
      </div>

      <button id="save-day" class="primary-button" style="margin-top:20px;">Guardar Todo</button>
    </div>
<div id="screen-weekly" class="screen">
  <div class="date-row" style="border:none;">
    <button id="back-from-weekly" style="padding-left:0; font-size:24px;">â†</button>
    <h1 class="title" style="margin:0;">Resumen PeriÃ³dico</h1>
    <div style="width:30px;"></div>
  </div>

  <!-- Selector tipo -->
  <h2 class="section-title">PerÃ­odo</h2>
  <div style="display:flex; gap:10px; margin-bottom:20px;">
    <button class="period-chip selected" data-period="7">Semanal</button>
    <button class="period-chip" data-period="14">Quincenal</button>
  </div>

  <!-- Rango de fechas -->
  <h2 class="section-title">Rango</h2>
  <div style="display:flex; gap:10px; margin-bottom:8px;">
    <button class="range-chip selected" data-range="default">Por defecto</button>
    <button class="range-chip" data-range="custom">Personalizado</button>
  </div>

  <div id="weekly-range-display" style="font-size:14px; color:#787774; margin-bottom:8px;"></div>

  <!-- Custom picker (oculto por defecto) -->
  <div id="custom-range-picker" style="display:none; margin-bottom:16px;">
    <div style="display:flex; gap:12px; align-items:center; font-size:14px;">
      <div>
        <label style="font-size:11px; color:#9B9A97; display:block; margin-bottom:4px;">DESDE</label>
        <input type="date" id="weekly-start-date" style="border:1px solid #E0E0E0; border-radius:6px; padding:8px; font-size:14px; color:#37352F;" />
      </div>
      <div style="padding-top:16px; color:#9B9A97;">â†’</div>
      <div>
        <label style="font-size:11px; color:#9B9A97; display:block; margin-bottom:4px;">HASTA</label>
        <input type="date" id="weekly-end-date" style="border:1px solid #E0E0E0; border-radius:6px; padding:8px; font-size:14px; color:#37352F;" readonly />
      </div>
    </div>
    <p style="font-size:11px; color:#9B9A97; margin-top:8px;">El perÃ­odo siempre es de 7 o 14 dÃ­as desde la fecha de inicio.</p>
  </div>

  <!-- Guardar preferencia -->
  <div id="save-preference-box" style="display:none; background:#F0F0F0; border-radius:8px; padding:12px; margin-bottom:16px; font-size:13px; color:#555;">
    Â¿Guardar esta configuraciÃ³n para futuros resÃºmenes?
    <div style="display:flex; gap:8px; margin-top:8px;">
      <button id="save-pref-yes" class="primary-button" style="height:32px; font-size:12px; margin-top:0;">SÃ­, guardar</button>
      <button id="save-pref-no" class="secondary-button" style="height:32px; font-size:12px; margin-top:0;">No</button>
    </div>
  </div>

  <button id="generate-weekly" class="primary-button">Generar Resumen</button>

  <!-- Resultado -->
  <div id="weekly-result" style="display:none; margin-top:24px;">
    <h2 class="section-title">Resumen</h2>
    <div class="box">
      <p id="weekly-summary-text" style="margin:0; font-size:14px; line-height:1.7;"></p>
    </div>
    <h2 class="section-title">Temas Recurrentes</h2>
    <div class="box">
      <p id="weekly-recurring-text" style="margin:0; font-size:14px; line-height:1.7;"></p>
    </div>
  </div>
</div>
 
</div>

  <script src="app.js"></script>

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/AI-diary-1.1/service-worker.js');
  }
</script>

</body>
</html>